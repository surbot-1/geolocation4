<!DOCTYPE html>
<html>
  
<head> 
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
 <title>editApp</title>

  <style> 
    
    body {
      background-color: #E0E0E0;
      width: 1080px;
      height: 2400px;
      margin: 0px; 
      padding: 0px;
    } 
    
    .div1 { 
      background-color: #009900;
      width: 1080px;
      height: 64px;
      font-size: 40px;
      font-weight: bold;
      text-align: center; 
      color: #FFFFFF;
      margin-top: 0px;
      margin-left: 0px;
    } 
    
    .div2 { 
      background-color: #999999;
      width: 1080px; 
      margin-top: 10px;
      margin-left: 0px;
    } 
    
    .p1 {
      color: #000000;
      font-size: 20px;
      margin-left: 20px;
    } 
    
    .button1 { 
      font-size: 20px; 
      margin-left: 20px;
    }
    
    .button2 { 
      font-size: 20px; 
      margin-left: 5px;
    }
    
    .p2 {
      color: #0000AA;
      font-size: 20px; 
      margin-left: 20px;
    } 
    
    
    .p3 {
      color: #0000AA;
      font-size: 20px; 
      margin-left: 20px; 
    } 
    
    .p4 {
      color: #AA0000;
      font-size: 10px;
      margin-top: 10px;
      margin-left: 20px;
    } 
    
    .p5 {
      color: #0000AA;
      font-size: 16px;
      margin-top: 20px;
      margin-left: 20px;
    }

  </style>

</head>
 

<body>

  <div class="div1"> 
    editApp - Sales Force Automation System - BSNL
  </div> 
 
  <div class="div2">
  <button class="button1" onclick="getlocation()">
    Coordinates
  </button>
  <button class="button2" onclick="refresh()">
    New
  </button> 
  <button class="button2" onclick="read()">
    Read
  </button> 
  <button class="button2" onclick="edit()">
    Edit
  </button>
  <button class="button2" onclick="save()">
    Save
  </button> 
  <button class="button2" onclick="remove()">
    Delete
  </button>  
  </div> 
  
  <p class="p1"> 
   Get Geolocation Latitude and Longitude <br>
   Accuracy depends on device <br>
   Recommended device - Apple's iPhone
  </p> 
  
  <p class="p2" id="demo2">
    Latitude : <br> 
    Longitude : 
  </p>
    
  <p class="p3" id="demo3">
    <input type="text" class="input" id="franchise" placeholder="Franchise Name and Code"> <br>
    <input type="text" class="input" id="fosname" placeholder="FOS Name and Code"> <br>
    <br>
    <input type="text" class="input" id="ctopno" placeholder="CTOPUP No."> <br>
    <input type="text" class="input" id="altno" placeholder="Alternate No."> <br>
    <input type="text" class="input" id="emailid" placeholder="Email ID"> <br>
    <input type="text" class="input" id="posname" placeholder="POS Name"> <br>
    <input type="text" class="input" id="posgend" placeholder="Gender"> <br>
    <input type="text" class="input" id="shopname" placeholder="Shop Name"> <br>
    <br>
    <input type="text" class="input" id="shopno" placeholder="Shop No."> <br>
    <input type="text" class="input" id="street" placeholder="Street/Village"> <br>
    <input type="text" class="input" id="landmark" placeholder="Landmark/PO"> <br>
    <input type="text" class="input" id="locality" placeholder="Locality/Tehsil"> <br>
    <input type="text" class="input" id="city" placeholder="City/District"> <br>
    <input type="text" class="input" id="state" placeholder="State/UT"> <br>
    <input type="text" class="input" id="pincode" placeholder="PIN Code"> <br>
    <br> 
    <input type="text" class="input" id="activation" placeholder=" Avg. Activation PM"> <br>
    <input type="text" class="input" id="mnp" placeholder="Avg. MNP PM "> <br>
    <input type="text" class="input" id="recharge" placeholder="Avg. Recharge PM"> <br>
    <br> 
    <input type="text" class="input" id="visitedby" placeholder="Visited By"> 
    <input type="button" class="input" id="autofill" value="Autofill" onclick="autofill()"> 
    <input type="button" class="input" id="previous" value="Previous" onclick="readAll()"> 
    <input type="button" class="input" id="preview" value="Preview" onclick="preview()"> 
  </p>
  <p class="p4" id="demo4"> 
      We respect our client's privacy <br>
      We do not store or share client's information
  </p> 
  <p class="p5" id="demo5"></p>
    
  
  <script type = "text/javascript"> 
         
         //prefixes of implementation that we want to test
         window.indexedDB = window.indexedDB || window.mozIndexedDB || 
         window.webkitIndexedDB || window.msIndexedDB;
         
         //prefixes of window.IDB objects
         window.IDBTransaction = window.IDBTransaction || 
         window.webkitIDBTransaction || window.msIDBTransaction;
         window.IDBKeyRange = window.IDBKeyRange || window.webkitIDBKeyRange || 
         window.msIDBKeyRange; 
         
         if (!window.indexedDB) {
            window.alert("Your browser doesn't support a stable version of IndexedDB."); 
         }  // else { alert('Ok'); } 
    
         var db; 
         openDB(); 
      function openDB() {
         var request = window.indexedDB.open("posbsnldb", 1); 
         request.onerror = function(event) {
            alert("error: ");
         }; 
         request.onsuccess = function(event) {
            db = request.result;
            // alert("success: "+ db);
         }; 
         request.onupgradeneeded = function(event) {
            var db = event.target.result;
            var objectStore = db.createObjectStore("posbsnl", {keyPath: "ctopno"}); 
            objectStore.createIndex('shopname', 'shopname', { unique: false });
         }; 
      }
    
  </script>
 
  <script> 
    
    var latitude = 0; 
    var longitude= 0 ; 
    var franchise; 
    var fosname; 
    var ctopno; 
    var altno; 
    var emailid; 
    var posname; 
    var posgend; 
    var shopname; 
    var shopno; 
    var street; 
    var landmark;
    var locality;
    var city; 
    var state; 
    var pincode; 
    var activation; 
    var mnp; 
    var recharge; 
    var visitedby; 
    
    var previewready = true; 
    var cordsreadready = true; 
    var saveready = false; 
    var readready = true; 
    var removeready = false; 

    var variable2 = document.getElementById("demo2"); 
    var variable3 = document.getElementById("demo3"); 
    var variable4 = document.getElementById("demo4"); 
    var variable5 = document.getElementById("demo5"); 
    
    function getlocation() {
      navigator.geolocation.getCurrentPosition(showLoc, errHand);
    }

    function showLoc(pos) { 
     if (cordsreadready) {
      variable2.innerHTML =
        "Latitude  : "; 
        "<br>" + 
        "Longitude : "; 
      variable2.innerHTML = 
        "Latitude  : " +
        pos.coords.latitude +
        "<br>" + 
        "Longitude : " +
        pos.coords.longitude; 
      latitude = pos.coords.latitude ;
      longitude = pos.coords.longitude ; 
     } else {} 
    }
 
    function errHand(err) {
      
      switch (err.code) {
          
        case err.PERMISSION_DENIED:
          variable1.innerHTML =
            "The application doesn't have the" +
            "permission to make use of location services";
          break;

        case err.POSITION_UNAVAILABLE:
          variable1.innerHTML = "The location of the device is uncertain";
          break;

        case err.TIMEOUT:
          variable1.innerHTML = "The request to get user location timed out";

          break;

        case err.UNKNOWN_ERROR:
          variable1.innerHTML =
            "Time to fetch location information exceeded" +
            "the maximum timeout interval";
          break;

      }

    } 
    
    function refresh() {
      // window.location.replace("https://surbot-1.github.io/geolocation4/"); 
      window.location.reload();
    } 
    
    function autofill() {
      
    }
    
    function previous() {
      
    }
    
    function preview() { 
        previewready = true; 
        cordsreadready = true; 
        saveready = true; 
        readready = false; 
        removeready = false; 
      // latitude;
      // longitude;
      franchise = document.getElementById("franchise").value; 
      fosname = document.getElementById("fosname").value; 
      ctopno = document.getElementById("ctopno").value; 
      altno = document.getElementById("altno").value; 
      emailid = document.getElementById("emailid").value; 
      posname = document.getElementById("posname").value; 
      posgend = document.getElementById("posgend").value; 
      shopname = document.getElementById("shopname").value; 
      shopno = document.getElementById("shopno").value; 
      street = document.getElementById("street").value; 
      landmark = document.getElementById("landmark").value;
      locality = document.getElementById("locality").value;
      city = document.getElementById("city").value; 
      state = document.getElementById("state").value; 
      pincode = document.getElementById("pincode").value; 
      activation = document.getElementById("activation").value; 
      mnp = document.getElementById("mnp").value; 
      recharge = document.getElementById("recharge").value; 
      visitedby = document.getElementById("visitedby").value; 
      
      variable2.innerHTML ="";
      variable2.innerHTML = 
        "Latitude        : " + latitude + "<br>" +
        "Longitude       : " + longitude ; 
      variable3.innerHTML ="";
      variable3.innerHTML = 
        "Franchise       : " + franchise + "<br>" +
        "FOS Name        : " + fosname + "<br>" + 
        "<br>" +
        "CTOPUP No       : " + ctopno + "<br>" +
        "Alternate No    : " + altno + "<br>" +
        "Email ID        : " + emailid + "<br>" +
        "POS Name        : " + posname + "<br>" +
        "Gender          : " + posgend + "<br>" +
        "Shop Name       : " + shopname + "<br>" + 
        "<br>" +
        "Shop No         : " + shopno + "<br>" +
        "Street/Village  : " + street + "<br>" +
        "Landmark/PO     : " + landmark + "<br>" +
        "Locality/Tehsil : " + locality + "<br>" +
        "City/District   : " + city + "<br>" +
        "State/UT        : " + state + "<br>" +
        "PIN Code        : " + pincode + "<br>" +
        "<br>" +
        "Avg. Activation PM : " + activation + "<br>" +
        "Avg. MNP PM        : " + mnp + "<br>" +
        "Avg. Recharge PM   : " + recharge + "<br>" +
        "<br>" +
        "Visited By : " + visitedby ;
    } 
    
    function save() { 
      if (saveready) { 
        previewready = false; 
        cordsreadready = false; 
        saveready = true; 
        readready = false; 
        removeready = true; 
        var request = db.transaction(["posbsnl"], "readwrite")
       .objectStore("posbsnl")
       .add({ 
           latitude: latitude, 
           longitude: longitude, 
           franchise: franchise, 
           fosname: fosname, 
           ctopno: ctopno, 
           altno: altno, 
           emailid: emailid, 
           posname: posname,
           posgend: posgend,
           shopname: shopname, 
           shopno: shopno, 
           street: street, 
           landmark: landmark, 
           locality: locality, 
           city: city, 
           state: state, 
           pincode: pincode, 
           activation: activation, 
           mnp: mnp, 
           recharge: recharge, 
           visitedby: visitedby
       }); 
       request.onsuccess = function(event) { 
              variable2.innerHTML ="";
              variable2.innerHTML =
                 "Latitude  : " + latitude + "<br>" +
                 "Longitude : " + longitude ; 
              variable3.innerHTML ="";
              variable3.innerHTML =
                 "Franchise       : " + franchise + "<br>" +
                 "FOS Name        : " + fosname + "<br>" + 
                 "<br>" +
                 "CTOPUP No       : " + ctopno + "<br>" +
                 "Alternate No    : " + altno + "<br>" +
                 "Email ID        : " + emailid + "<br>" +
                 "POS Name        : " + posname + "<br>" +
                 "Gender          : " + posgend + "<br>" +
                 "Shop Name       : " + shopname + "<br>" + 
                 "<br>" +
                 "Shop No         : " + shopno + "<br>" +
                 "Street/Village  : " + street + "<br>" +
                 "Landmark/PO     : " + landmark + "<br>" +
                 "Locality/Tehsil : " + locality + "<br>" +
                 "City/District   : " + city + "<br>" +
                 "State/UT        : " + state + "<br>" +
                 "PIN Code        : " + pincode + "<br>" +
                 "<br>" +
                 "Avg. Activation PM : " + activation + "<br>" +
                 "Avg. MNP PM        : " + mnp + "<br>" +
                 "Avg. Recharge PM   : " + recharge + "<br>" +
                 "<br>" +
                 "Visited By : " + visitedby ;
         alert(ctopno + " " + "saved successfully"); 
       };  
       request.onerror = function(event) {
          alert(ctopno + " " + "already exist");
       }; 
      } else {} 
    }
    
    function read() { 
      if (readready) { 
        previewready = false; 
        cordsreadready = false; 
        saveready = false; 
        readready = true; 
        removeready = true; 
        
        var request; 
        var toread = document.getElementById("ctopno").value; 
        if (toread != "") { 
            var transaction = db.transaction(["posbsnl"]);
            var objectStore = transaction.objectStore("posbsnl");
            request = objectStore.get(toread); 
           } // else { 
          // toread = document.getElementById("shopname").value; 
          // var transaction = db.transaction(["posbsnl"]);
          // var objectStore = transaction.objectStore("posbsnl");
          // var index = objectStore.index("shponame");
          // request = index.get(toread); 
        // } 
       request.onsuccess = function(event) {
               // Do something with the request.result!
               if(request.result) { 
                  latitude = request.result.latitude; 
                  longitude = request.result.longitude; 
                  franchise = request.result.franchise; 
                  fosname = request.result.fosname; 
                  ctopno = request.result.ctopno;  
                  altno = request.result.altno;  
                  emailid = request.result.emailid; 
                  posname = request.result.posname;  
                  posgend = request.result.posgend;  
                  shopname = request.result.shopname; 
                  shopno = request.result.shopno; 
                  street = request.result.street;  
                  landmark = request.result.landmark;  
                  locality = request.result.locality; 
                  city = request.result.city;  
                  state = request.result.state;  
                  pincode = request.result.pincode;  
                  activation = request.result.activation;  
                  mnp = request.result.mnp;  
                  recharge = request.result.recharge;  
                  visitedby = request.result.visitedby; 
                 variable2.innerHTML ="";
                 variable2.innerHTML =
                 "Latitude  : " + latitude + "<br>" +
                 "Longitude : " + longitude ; 
                 variable3.innerHTML ="";
                 variable3.innerHTML =
                 "Franchise       : " + franchise + "<br>" +
                 "FOS Name        : " + fosname + "<br>" + 
                 "<br>" +
                 "CTOPUP No       : " + ctopno + "<br>" +
                 "Alternate No    : " + altno + "<br>" +
                 "Email ID        : " + emailid + "<br>" +
                 "POS Name        : " + posname + "<br>" +
                 "Gender          : " + posgend + "<br>" +
                 "Shop Name       : " + shopname + "<br>" + 
                 "<br>" +
                 "Shop No         : " + shopno + "<br>" +
                 "Street/Village  : " + street + "<br>" +
                 "Landmark/PO     : " + landmark + "<br>" +
                 "Locality/Tehsil : " + locality + "<br>" +
                 "City/District   : " + city + "<br>" +
                 "State/UT        : " + state + "<br>" +
                 "PIN Code        : " + pincode + "<br>" +
                 "<br>" +
                 "Avg. Activation PM : " + activation + "<br>" +
                 "Avg. MNP PM        : " + mnp + "<br>" +
                 "Avg. Recharge PM   : " + recharge + "<br>" +
                 "<br>" +
                 "Visited By : " + visitedby ;
                 
               } else {
                  alert(toread + " " + "couldn't be found!");
               }
            }; 
      request.onerror = function(event) {
               alert("Unable to retrieve!");
            }; 
      } else {} 
    } 
    
    function readAll() { 
            variable5.innerHTML =""; 
            variable5.innerHTML += 
            "All POS" + "<br>";
            var serialno = 1; 
            var transaction = db.transaction(["posbsnl"]);
            var objectStore = transaction.objectStore("posbsnl");
        
            objectStore.openCursor().onsuccess = function(event) {
               var cursor = event.target.result; 
              
               if (cursor) { 
                  var latitude = cursor.value.latitude; 
                  var longitude = cursor.value.longitude; 
                  var franchise = cursor.value.franchise; 
                  var fosname = cursor.value.fosname; 
                  var ctopno = cursor.key;  
                  var altno = cursor.value.altno;  
                  var emailid = cursor.value.emailid; 
                  var posname = cursor.value.posname;  
                  var posgend = cursor.value.posgend;  
                  var shopname = cursor.value.shopname; 
                  var shopno = cursor.value.shopno; 
                  var street = cursor.value.street;  
                  var landmark = cursor.value.landmark;  
                  var locality = cursor.value.locality; 
                  var city = cursor.value.city;  
                  var state = cursor.value.state;  
                  var pincode = cursor.value.pincode;  
                  var activation = cursor.value.activation;  
                  var mnp = cursor.value.mnp;  
                  var recharge = cursor.value.recharge;  
                  var visitedby = cursor.value.visitedby; 
                 // variable5.innerHTML += 
                 // "Serial No: " + serialno + "<br>" +
                 // "Latitude  : " + latitude + "<br>" +
                 // "Longitude : " + longitude + "<br>" + 
                 // "<br>" + 
                 // "Franchise       : " + franchise + "<br>" +
                 // "FOS Name        : " + fosname + "<br>" + 
                 // "<br>" +
                 // "CTOPUP No       : " + ctopno + "<br>" +
                 // "Alternate No    : " + altno + "<br>" +
                 // "Email ID        : " + emailid + "<br>" +
                 // "POS Name        : " + posname + "<br>" +
                 // "Gender          : " + posgend + "<br>" +
                 // "Shop Name       : " + shopname + "<br>" + 
                 // "<br>" +
                 // "Shop No         : " + shopno + "<br>" +
                 // "Street/Village  : " + street + "<br>" +
                 // "Landmark/PO     : " + landmark + "<br>" +
                 // "Locality/Tehsil : " + locality + "<br>" +
                 // "City/District   : " + city + "<br>" +
                 // "State/UT        : " + state + "<br>" +
                 // "PIN Code        : " + pincode + "<br>" +
                 // "<br>" +
                 // "Avg. Activation PM : " + activation + "<br>" +
                 // "Avg. MNP PM        : " + mnp + "<br>" +
                 // "Avg. Recharge PM   : " + recharge + "<br>" +
                 // "<br>" +
                 // "Visited By : " + visitedby + "<br>" +
                 // "<br>" + 
                 // "<br>" ; 
                  variable5.innerHTML += 
                    serialno + "." + " " + 
                    ctopno + " " + 
                    altno + " " + 
                    shopname + "<br>"; 
                  serialno++; 
                  cursor.continue();
               } else { 
                  variable5.innerHTML += 
                  "Total POS Count = " + (serialno-1); 
                  // alert("No more entries!");
               }
            };
    } 
    
    function edit() {
      
    }
    
    function remove() { 
      if (removeready) { 
        previewready = false; 
        cordsreadready = false; 
        saveready = true; 
        readready = false; 
        removeready = true; 
            var toremove = ctopno; 
            // var toremove = document.getElementById("ctopno").value;
            var request = db.transaction(["posbsnl"], "readwrite")
            .objectStore("posbsnl")
            .delete(toremove);
            
            request.onsuccess = function(event) { 
                 variable2.innerHTML ="";
                 variable2.innerHTML =
                 "Latitude  : " + " " + "<br>" +
                 "Longitude : " + " " ; 
                 variable3.innerHTML ="";
                 variable3.innerHTML =
                 "Franchise       : " + " " + "<br>" +
                 "FOS Name            : " + " " + "<br>" + 
                 "<br>" +
                 "CTOPUP No       : " + " " + "<br>" +
                 "Alternate No    : " + " " + "<br>" +
                 "Email ID        : " + " " + "<br>" +
                 "POS Name   : " + " " + "<br>" +
                 "Gender          : " + " " + "<br>" +
                 "Shop Name       : " + " " + "<br>" + 
                 "<br>" +
                 "Shop No         : " + " " + "<br>" +
                 "Street/Village  : " + " " + "<br>" +
                 "Landmark/PO     : " + " " + "<br>" +
                 "Locality/Tehsil : " + " " + "<br>" +
                 "City/District   : " + " " + "<br>" +
                 "State/UT        : " + " " + "<br>" +
                 "PIN Code        : " + " " + "<br>" +
                 "<br>" +
                 "Avg. Activation PM : " + " " + "<br>" +
                 "Avg. MNP PM        : " + " " + "<br>" +
                 "Avg. Recharge PM   : " + " " + "<br>" +
                 "<br>" + 
                 "Visited By : " + " " ;
               alert(toremove + " " + "has been removed successfully");
            }; 
            request.onerror = function(event) {
               alert("Unable to remove!"); 
            }; 
      } else {}
    } 
    
    function removeAll() {
      
    }
 
    
  </script>

</body>
</html>











